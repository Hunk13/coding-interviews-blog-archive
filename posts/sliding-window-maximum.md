Sliding Window Maximum
======================

Jan 4, 2021 ¬∑ 4 min read

–î–∞–Ω –º–∞—Å—Å–∏–≤ —á–∏—Å–µ–ª `nums` –∏ —à–∏—Ä–∏–Ω–∞ –æ–∫–Ω–∞ `k`, —Ç.–µ. –≤ –∫–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è —Ä–æ–≤–Ω–æ `k` —á–∏—Å–µ–ª. –û–∫–Ω–æ –¥–≤–∏–∂–µ—Ç—Å—è —Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ —Å —à–∞–≥–æ–º –≤ –æ–¥–Ω–æ —á–∏—Å–ª–æ. –ù–∞–π—Ç–∏ –º–∞–∫—Å–∏–º—É–º—ã –≤ —Å–∫–æ–ª—å–∑—è—â–µ–º –æ–∫–Ω–µ.

![](/images/sliding-window-maximum--ex.jpg)

–†–µ—à–µ–Ω–∏–µ¬†[#](#—Ä–µ—à–µ–Ω–∏–µ)
---------------------

–†–µ—à–µ–Ω–∏–µ ¬´–≤ –ª–æ–±¬ª ‚Äî –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å –≤—Å–µ —á–∏—Å–ª–∞ –≤ –æ–∫–Ω–µ, –Ω–∞—Ö–æ–¥—è –º–∞–∫—Å–∏–º—É–º –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ —Å–Ω–æ–≤–∞.

    /**
     * @param {number[]} nums
     * @param {number} k
     * @return {number[]}
     */
    var maxSlidingWindow = function(nums, k) {
      const result = [];
    
      for (let i = k; i <= nums.length; i++) {
        // ¬´–≤—ã—Ä–µ–∑–∞–µ–º¬ª –æ–∫–Ω–æ –∏ –∏—â–µ–º –º–∞–∫—Å–∏–º—É–º –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ
        result.push(Math.max(...nums.slice(i - k, i)));
      }
      return result;
    };
    

–°–ª–æ–∂–Ω–æ—Å—Ç—å ‚Äî `O(n * k)`. –ï—Å–ª–∏ —Å–¥–∞—Ç—å —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ, —Ç–æ –ø–æ–ª—É—á–∏–º TLE.

![](/images/sliding-window-maximum--bruteforce.jpg)

–ù–µ –∑—Ä—è —ç—Ç–∞ –∑–∞–¥–∞—á–∫–∞ –ø–æ–º–µ—á–µ–Ω–∞ –∫–∞–∫ ¬´hard¬ª ‚Äì –±—Ä—É—Ç—Ñ–æ—Ä—Å —É–∂–µ –Ω–µ –ø—Ä–æ–∫–∞—Ç–∏—Ç.

–ö–∞–∫ –≤—Å–µ–≥–¥–∞, –Ω–∞ —ç—Ç–æ–º –º–æ–º–µ–Ω—Ç–µ –Ω—É–∂–Ω–æ –∑–∞–¥–∞—Ç—å —Å–µ–±–µ –≤–æ–ø—Ä–æ—Å: ¬´–≥–¥–µ —Å–æ–≤–µ—Ä—à–∞–µ—Ç—Å—è –ª–∏—à–Ω—è—è —Ä–∞–±–æ—Ç–∞?¬ª. –í –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ —à–∏—Ä–∏–Ω–∞ –æ–∫–Ω–∞ `k` —Ä–∞–≤–Ω–∞ 50000. –° –∫–∞–∂–¥—ã–º —à–∞–≥–æ–º –≤ –æ–∫–Ω–µ –º–µ–Ω—è–µ—Ç—Å—è –≤—Å–µ–≥–æ –Ω–µ –±–æ–ª–µ–µ 2 —á–∏—Å–µ–ª –∏–∑ 50000, –∞ –ø–µ—Ä–µ—á–∏—Ç—ã–≤–∞–µ–º –º—ã –≤—Å–µ –∫–∞–∂–¥—ã–π —Ä–∞–∑! –î–∞–≤–∞–π—Ç–µ –ø–æ–¥—É–º–∞–µ–º –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç–µ–µ.

–û–∫–Ω–æ –¥–∞–∂–µ –≤–Ω–µ—à–Ω–µ –ø–æ—Ö–æ–∂–µ –Ω–∞ –æ—á–µ—Ä–µ–¥—å ‚Äî –¥–≤—É—Å–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫, –≤ –∫–æ—Ç–æ—Ä–æ–º –º—ã –∏–º–µ–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞ `O(1)` –ø–∏—Å–∞—Ç—å –∏ —á–∏—Ç–∞—Ç—å —Å –æ–±–µ–∏—Ö —Å—Ç–æ—Ä–æ–Ω: –∫–∞–∫ —Å –≥–æ–ª–æ–≤—ã, —Ç–∞–∫ –∏ —Å —Ö–≤–æ—Å—Ç–∞.

–ü–æ-–º–æ–µ–º—É, –µ—Å—Ç—å –¥–≤–∞ –∫–ª—é—á–µ–≤—ã—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥–∞—é—Ç –ø—Ä–∏–π—Ç–∏ –∫ —Ä–µ—à–µ–Ω–∏—é —Å –æ—á–µ—Ä–µ–¥—å—é:

*   –∫–∞–∫ —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ –≤—ã—à–ª–æ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—É –æ–∫–Ω–∞ —Å–ª–µ–≤–∞, –µ–≥–æ –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏–∑ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è
*   –∫–∞–∫ —Ç–æ–ª—å–∫–æ –Ω–æ–≤–æ–µ —á–∏—Å–ª–æ –≤–æ—à–ª–æ –≤ –ø—Ä–µ–¥–µ–ª—ã –æ–∫–Ω–∞ —Å–ø—Ä–∞–≤–∞, –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏–∑ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è –≤—Å–µ —á–∏—Å–ª–∞, –∫–æ—Ç–æ—Ä—ã–µ –º–µ–Ω—å—à–µ —á–µ–º —ç—Ç–æ —á–∏—Å–ª–æ

–ü–µ—Ä–≤–æ–µ –ø–æ—á—Ç–∏ –æ—á–µ–≤–∏–¥–Ω–æ, –∞ –≤–æ—Ç –¥–æ –≤—Ç–æ—Ä–æ–≥–æ –Ω—É–∂–Ω–æ –¥–æ–≥–∞–¥–∞—Ç—å—Å—è ‚Äî –ø–æ–Ω—è—Ç–Ω–µ–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –µ—Å–ª–∏ –Ω–∞—Ä–∏—Å–æ–≤–∞—Ç—å.

![](/images/sliding-window-maximum--keys.jpg)

–í –Ω–∞—á–∞–ª–µ –æ—á–µ—Ä–µ–¥–∏ –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∞–∫—Å–∏–º—É–º –≤ –æ–∫–Ω–µ. –ï—Å–ª–∏ –Ω–∞–º –ø—Ä–∏—Ö–æ–¥—è—Ç —á–∏—Å–ª–∞, –∫–æ—Ç–æ—Ä—ã–µ –º–µ–Ω—å—à–µ —Ç–µ–∫—É—â–µ–≥–æ –º–∞–∫—Å–∏–º—É–º–∞ ‚Äî –º—ã —Å–ø–æ–∫–æ–π–Ω–æ –∫–ª–∞–¥—ë–º –∏—Ö –≤ –æ—á–µ—Ä–µ–¥—å, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –º–æ–≥—É—Ç —Å—Ç–∞—Ç—å –º–∞–∫—Å–∏–º—É–º–∞–º–∏ –≤ –±—É–¥—É—â–µ–º. –ï—Å–ª–∏ –Ω–∞–º –ø—Ä–∏—Ö–æ–¥—è—Ç —á–∏—Å–ª–∞, –∫–æ—Ç–æ—Ä—ã–µ –±–æ–ª—å—à–µ —Ç–µ–∫—É—â–µ–≥–æ –º–∞–∫—Å–∏–º—É–º–∞ ‚Äî –º—ã —É–¥–∞–ª—è–µ–º –≤—Å—ë —á—Ç–æ –º–µ–Ω—å—à–µ, –ø–æ–∫–∞ –æ—á–µ—Ä–µ–¥—å –Ω–µ –æ–ø—É—Å—Ç–µ–µ—Ç –∏ –Ω–æ–≤—ã–π –º–∞–∫—Å–∏–º—É–º –Ω–µ –∑–∞–π–º—ë—Ç —Å–≤–æ—ë –º–µ—Å—Ç–æ –≤ –Ω–∞—á–∞–ª–µ.

–ö–∞–∂–¥–æ–µ —á–∏—Å–ª–æ –º—ã —Ç—Ä–æ–≥–∞–µ–º –Ω–µ –±–æ–ª–µ–µ 2 —Ä–∞–∑ (–ø–æ–ª–æ–∂–∏—Ç—å –≤ –æ—á–µ—Ä–µ–¥—å, —É–¥–∞–ª–∏—Ç—å –∏–∑ –æ—á–µ—Ä–µ–¥–∏), –ø–æ—ç—Ç–æ–º—É –∏—Ç–æ–≥–æ–≤–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å `O(n)`. –¢–æ –µ—Å—Ç—å –≤–æ–æ–±—â–µ –Ω–µ –≤–∞–∂–µ–Ω —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞!

    /**
     * @param {number[]} nums
     * @param {number} k
     * @return {number[]}
     */
    var maxSlidingWindow = function(nums, k) {
      const q = [];
      const result = [];
    
      for (let i = 0; i < nums.length; i++) {
        // —É–¥–∞–ª—è–µ–º –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∏–Ω–¥–µ–∫—Å —Å–ª–µ–≤–∞ –∫–∞–∂–¥—ã–π —Ä–∞–∑,
        // –∫–æ–≥–¥–∞ –æ–∫–Ω–æ –¥–≤–∏–≥–∞–µ—Ç—Å—è –≤–ø—Ä–∞–≤–æ
        if (q.length > 0 && q[0] < i - k + 1) {
          q.shift();
        }
        // —É–¥–∞–ª—è–µ–º –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∏–Ω–¥–µ–∫—Å —Å–ø—Ä–∞–≤–∞ ‚Äî
        // –≤—Å–µ, –∫–æ—Ç–æ—Ä—ã–µ —Ç–æ—á–Ω–æ —É–∂–µ –Ω–µ —Å—Ç–∞–Ω—É—Ç –º–∞–∫—Å–∏–º—É–º–∞–º–∏,
        // –ø–æ –º–µ—Ä–µ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è –æ–∫–Ω–∞ –Ω–∞–ø—Ä–∞–≤–æ
        while (q.length > 0 && nums[q[q.length - 1]] < nums[i]) {
          q.pop();
        }
        // –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å –≤ –∫–æ–Ω–µ—Ü –æ—á–µ—Ä–µ–¥–∏
        q.push(i);
        // –≥–æ–ª–æ–≤–∞ –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–∞–∫—Å–∏–º—É–º
        if (i >= k - 1) {
          result.push(nums[q[0]]);
        }
      }
      return result;
    };
    

![](/images/sliding-window-maximum--result-slow.jpg)

–í JavaScript –Ω–µ—Ç –æ—á–µ—Ä–µ–¥–∏ –∏–ª–∏ —Å–≤—è–∑–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ, –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—ã—á–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã. –ú–æ–∂–Ω–æ —Å–ª–µ–≥–∫–∞ —É—Å–∫–æ—Ä–∏—Ç—å—Å—è –µ—Å–ª–∏ –≤—Å—ë –∂–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∞—Å—Å–∏–≤, –∞ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ–π, –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–π, —Å–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫.

–ï—Å–ª–∏ –Ω–∞–º –Ω–µ –Ω—É–∂–Ω–æ –Ω–∏—á–µ–≥–æ –¥–æ–±–∞–≤–ª—è—Ç—å –≤ –Ω–∞—á–∞–ª–æ, –∞ —Ç–æ–ª—å–∫–æ —Å–Ω–∏–º–∞—Ç—å, —Ç–æ –µ—Å—Ç—å –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (–ø—Ä–∞–≤–¥–∞, –Ω–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏), –∫–æ—Ç–æ—Ä—É—é —è –ø—Ä–∏–≤–µ–¥—É –Ω–∏–∂–µ.

–ò–º–µ–µ—Ç –ª–∏ —Å–º—ã—Å–ª —Ç–∞–∫ –¥–µ–ª–∞—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ ‚Äî –±–æ–ª—å—à–æ–π –≤–æ–ø—Ä–æ—Å, –∞ –≤–æ—Ç –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ —Ç–æ—á–Ω–æ –º–æ–≥—É—Ç —Å–ø—Ä–æ—Å–∏—Ç—å, –ø–æ—Ç–æ–º—É —á—Ç–æ –º–∏–ª–æ–µ –¥–µ–ª–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∂–µ, –µ—Å–ª–∏ –≤—Ä–µ–º—è –æ—Å—Ç–∞—ë—Ç—Å—è.

–°–ø–µ—Ä–≤–∞ –æ–±–Ω–æ–≤–∏–º –∫–æ–¥ —Å–∞–º–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è.

    /**
     * @param {number[]} nums
     * @param {number} k
     * @return {number[]}
     */
    var maxSlidingWindow = function(nums, k) {
    - const q = [];
    + const q = new LinkedList();
      const result = [];
    
      for (let i = 0; i < nums.length; i++) {
        // —É–¥–∞–ª—è–µ–º –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∏–Ω–¥–µ–∫—Å —Å–ª–µ–≤–∞ –∫–∞–∂–¥—ã–π —Ä–∞–∑
        // –∫–æ–≥–¥–∞ –æ–∫–Ω–æ –¥–≤–∏–≥–∞–µ—Ç—Å—è –≤–ø—Ä–∞–≤–æ
    -   if (q.length > 0 && q[0] < i - k + 1) {
    +   if (q.length > 0 && q.front() < i - k + 1) {
          q.shift();
        }
        // —É–¥–∞–ª—è–µ–º –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –∏–Ω–¥–µ–∫—Å —Å–ø—Ä–∞–≤–∞,
        // –≤—Å–µ –∫–æ—Ç–æ—Ä—ã–µ —Ç–æ—á–Ω–æ —É–∂–µ –Ω–µ —Å—Ç–∞–Ω—É—Ç –º–∞–∫—Å–∏–º—É–º–∞–º–∏
        // –ø–æ –º–µ—Ä–µ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è –æ–∫–Ω–∞ –Ω–∞–ø—Ä–∞–≤–æ
    -   while (q.length > 0 && nums[q[q.length - 1]] < nums[i]) {
    +   while (q.length > 0 && nums[q.back()] < nums[i]) {
          q.pop();
        }
        // –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å –≤ –∫–æ–Ω–µ—Ü –æ—á–µ—Ä–µ–¥–∏
        q.push(i);
        // –≥–æ–ª–æ–≤–∞ –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–∞–∫—Å–∏–º—É–º
        if (i >= k - 1) {
    -     result.push(nums[q[0]]);
    +     result.push(nums[q.front());
        }
      }
      return result;
    };
    

–ö–∞–∫ –≤–∏–¥–Ω–æ, –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ—á—Ç–∏ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è: –≤–º–µ—Å—Ç–æ –æ–±—Ä–∞—â–µ–Ω–∏—è –ø–æ –∏–Ω–¥–µ–∫—Å–∞–º–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è –º–µ—Ç–æ–¥—ã –¥–ª—è —á—Ç–µ–Ω–∏—è —Å –≥–æ–ª–æ–≤—ã –∏ —Ö–≤–æ—Å—Ç–∞, –æ—Å—Ç–∞–ª—å–Ω–æ–µ –≤—Å—ë —Ç–∞–∫ –∂–µ –∫–∞–∫ —É –º–∞—Å—Å–∏–≤–∞ ‚Äî –¥–∏—Ñ—Ñ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–π. –ù–∞–∫–æ–Ω–µ—Ü, —Å–∞–º–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è.

    class LinkedList {
      constructor() {
        this.q = [];
        this.head = 0;
      }
      push(v) {
        this.q.push(v);
      }
      pop() {
        return this.q.pop();
      }
      shift() {
        this.q[this.head++];
      }
      front() {
        return this.q[this.head];
      }
      back() {
        return this.q[this.q.length - 1];
      }
      get length() {
        return this.q.length - this.head;
      }
    }
    

–í—Å—è —Å–æ–ª—å –≤ —Ç–æ–º, —á—Ç–æ –º—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —Å –Ω–∞—á–∞–ª–∞, –∞ –ø—Ä–æ—Å—Ç–æ –¥–≤–∏–≥–∞–µ–º —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –≥–æ–ª–æ–≤—É –¥–∞–ª—å—à–µ.

![](/images/sliding-window-maximum--result.jpg)

PS. –û–±—Å—É–¥–∏—Ç—å –º–æ–∂–Ω–æ –≤ [—Ç–µ–ª–µ–≥—Ä–∞–º-—á–∞—Ç–µ](https://t.me/ctci_chat_ru) –ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–≤. Welcome! ü§ó

–ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Ç–µ—Å—å –Ω–∞ [–º–æ–π —Ç–≤–∏—Ç–µ—Ä](https://twitter.com/vitkarpov) –∏–ª–∏ [–∫–∞–Ω–∞–ª –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–µ](https://t.me/coding_interviews), —á—Ç–æ–±—ã —É–∑–Ω–∞–≤–∞—Ç—å –æ –Ω–æ–≤—ã—Ö —Ä–∞–∑–±–æ—Ä–∞—Ö –∑–∞–¥–∞—á.
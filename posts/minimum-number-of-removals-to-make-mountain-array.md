Minimum Number of Removals to Make Mountain Array
=================================================

Nov 30, 2020 ¬∑ 3 min read

**Mountain Array** –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–∞–∫–æ–π –º–∞—Å—Å–∏–≤, —á—Ç–æ –µ—Å—Ç—å —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∏—Ç –º–∞—Å—Å–∏–≤ –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏: —Å—Ç—Ä–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â—É—é –∏ —Å—Ç—Ä–æ–≥–æ —É–±—ã–≤–∞—é—â—É—é. –ü–æ–ª—É—á–∞–µ—Ç—Å—è –∫–∞–∫ –±—ã ¬´–ø–∏–∫¬ª –º–µ–∂–¥—É –Ω–∏–º–∏.

–Ø —Ä–∞–∑–±–∏—Ä–∞–ª [–∑–∞–¥–∞—á—É –ø—Ä–æ –ø–æ–∏—Å–∫ ¬´–ø–∏–∫–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞¬ª](https://www.notion.so/Peak-Index-in-a-Mountain-Array-de355555babb4d63898aa70e05ed20a6) –≤ —Ç–∞–∫–æ–º –º–∞—Å—Å–∏–≤–µ.

![](/images/minimum-number-of-removals-to-make-mountain-array--example.jpg)

–ê –≤ —ç—Ç–æ–π –∑–∞–¥–∞—á–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–π—Ç–∏ _–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ_ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏–∑ –º–∞—Å—Å–∏–≤–∞, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤—à–∏–π—Å—è –º–∞—Å—Å–∏–≤ —Å—Ç–∞–ª Mountain Array.

–†–µ—à–µ–Ω–∏–µ¬†[#](#—Ä–µ—à–µ–Ω–∏–µ)
---------------------

–ù–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤:

    [2,1,1,5,6,2,3,1]
    

–ú–æ–∂–µ–º —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ 0,1,5 –∏ –ø–æ–ª—É—á–∏–º `[1,5,6,3,1]` (6 ‚Äî –ø–∏–∫).

    [4,3,2,1,1,2,3,1]
    

–ú–æ–∂–µ–º —É–¥–∞–ª–∏—Ç—å –ø–µ—Ä–≤—ã–µ —á–µ—Ç—ã—Ä–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏ –ø–æ–ª—É—á–∏–º `[1,2,3,1]` (3 ‚Äî –ø–∏–∫).

–í–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Ä–µ–∞–ª—å–Ω–æ —É–¥–∞–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã, –Ω–∞ —ç—Ç—É –∑–∞–¥–∞—á—É –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–µ–º–Ω–æ–≥–æ –∏–Ω–∞—á–µ ‚Äî —á—Ç–æ –µ—Å–ª–∏ –º—ã –±—É–¥–µ–º –∏—Å–∫–∞—Ç—å mountain array –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã?

–†–∞–∑—É–º–µ–µ—Ç—Å—è –∏—Å–∫–∞—Ç—å –Ω—É–∂–Ω–æ —Å —É—á–µ—Ç–æ–º –ø—Ä–æ–ø—É—Å–∫–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤, —Ç.–µ. —Å—Ä–µ–¥–∏ _–ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π_.

> –í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –ø–æ–¥–º–∞—Å—Å–∏–≤–æ–º (subarray) –∏ –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é (subsequence)?

–¢–æ–≥–¥–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–≤–µ—Ç–∞ –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –¥–ª–∏–Ω–æ–π –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –∏ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ, –ø–æ–ª—É—á–∏–º _–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ_ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å.

–ö–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –∏—Å–∫–∞—Ç—å mountain array –≤ –º–∞—Å—Å–∏–≤–µ —Å—Ä–µ–¥–∏ –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π?

–í —ç—Ç–æ–º –ø–æ–º–æ–∂–µ—Ç —Ö–æ—Ä–æ—à–æ –∏–∑–≤–µ—Å—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞ –ø–æ–∏—Å–∫–∞ –Ω–∞–∏–±–æ–ª—å—à–µ–π –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–µ–π –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (Longest Increasing Subsequence).

–ò –∑–¥–µ—Å—å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ**.

–ü—É—Å—Ç—å `dp[i]` ‚Äî –¥–ª–∏–Ω–∞ –Ω–∞–∏–±–æ–ª—å—à–µ–π –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–µ–π –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–æ `i`\-–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞. –ß—Ç–æ –≤–∞–∂–Ω–æ –≤ –¥–ø—à–µ—á–∫–µ? –†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ.

–î–æ–ø—É—Å—Ç–∏–º, –Ω–∞–º –∏–∑–≤–µ—Å—Ç–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ `dp[i]`. –ö–∞–∫ –Ω–∞–π—Ç–∏ `dp[i + 1]`?

–í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ _—Å—Ç—Ä–æ–≥–æ –º–µ–Ω—å—à–µ_ `i + 1`\-–≥–æ (—á—Ç–æ–±—ã —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è), –º–æ–≥—É—Ç –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω—ã –≤ –Ω–æ–≤—É—é –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å `i + 1` —ç–ª–µ–º–µ–Ω—Ç–æ–º –Ω–∞ –∫–æ–Ω—Ü–µ.

–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –Ω–∞–¥–æ –ø—Ä–æ–π—Ç–∏—Å—å –ø–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º `dp` –¥–æ `i` (—Ç.–µ. –¥–ª–∏–Ω–∞–º) –∏ –Ω–∞–π—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π ‚Äî —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º—ã –≤–∫–ª—é—á–∏–º `i + 1` —ç–ª–µ–º–µ–Ω—Ç –≤ _–Ω–∞–∏–±–æ–ª—å—à—É—é –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å_, –∞ `dp[i + 1]` –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω –Ω–∞–π–¥–µ–Ω–Ω—ã–π –º–∞–∫—Å–∏–º—É–º –ø–ª—é—Å –æ–¥–∏–Ω.

    /**
     * @param {number[]} nums
     * @return {number[]}
     */
    function LIS(nums) {
      const result = [...Array(nums.length)].fill(1);
    
      for (let i = 1; i < nums.length; i++) {
        // –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø—Ä–æ—Ö–æ–¥–∏–º—Å—è –ø–æ –≤—Å–µ–º dp[j], j = 0..i
        // —Ç.–µ. —Å–º–æ—Ç—Ä–∏–º –Ω–∞ –≤—Å–µ –¥–ª–∏–Ω—ã –î–û,
        // —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        for (let j = 0; j < i; j++) {
          // —É–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –Ω–∞—Ö–æ–¥–∏–º—Å—è
          // –≤–Ω—É—Ç—Ä–∏ –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–µ–π –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
          if (nums[i] > nums[j]) {
            result[i] = Math.max(result[j] + 1, result[i]);
          }
        }
      }
      return result;
    }
    

–°–ª–æ–∂–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è ‚Äî `O(n^2)`, –≥–¥–µ `n` - –¥–ª–∏–Ω–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞.

–ö–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –≤ —Ä–µ—à–µ–Ω–∏–∏ –∏—Å—Ö–æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏? –ú—ã –º–æ–∂–µ–º –Ω–∞–π—Ç–∏ LIS —Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ –∏ —Å–ø—Ä–∞–≤–∞ –Ω–∞–ª–µ–≤–æ, –ø–æ–ª—É—á–∏–≤ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –Ω–∞–∏–±–æ–ª—å—à–∏–µ –¥–ª–∏–Ω—ã –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–µ–π –∏ —É–±—ã–≤–∞—é—â–µ–π (—Å–ø—Ä–∞–≤–∞ –Ω–∞–ª–µ–≤–æ) –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π.

–¢–µ–ø–µ—Ä—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –º—ã –º–æ–∂–µ–º —Å–∫–∞–∑–∞—Ç—å –Ω–∞–∏–±–æ–ª—å—à–∏–µ –¥–ª–∏–Ω—ã –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π _–≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–µ–π –¥–æ_ –∏ _—É–±—ã–≤–∞—é—â–µ–π –ø–æ—Å–ª–µ_ –¥–∞–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞, –∞ —ç—Ç–æ –∫–∞–∫ —Ä–∞–∑ –∏ –µ—Å—Ç—å ¬´–ø–∏–∫–∏¬ª –Ω—É–∂–Ω—ã—Ö –Ω–∞–º mountain array.

    /**
     * @param {number[]} nums
     * @return {number}
     */
    var minimumMountainRemovals = function(nums) {
      // –Ω–∞—Ö–æ–¥–∏–º –¥–ª–∏–Ω—ã –Ω–∞–∏–±–æ–ª—å—à–∏—Ö
      // –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–µ–π –∏ —É–±—ã–≤–∞—é—â–µ–π –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π
      const leftLIS = LIS(nums);
      const rightLIS = LIS(nums.reverse()).reverse();
    
      let result = 0;
      // –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ ¬´–ø–∏–∫–∏¬ª
      // –∏ –∏—â–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É
      for (let i = 1; i < nums.length - 1; i++) {
        // –¥–ª–∏–Ω—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –±–æ–ª—å—à–µ 1
        // —á—Ç–æ–±—ã i-–π —ç–ª–µ–º–µ–Ω—Ç –±—ã–ª –≤–∞–ª–∏–¥–Ω—ã–º ¬´–ø–∏–∫–æ–º¬ª
        if (leftLIS[i] > 1 && rightLIS[i] > 1) {
          // -1 —á—Ç–æ–±—ã –Ω–µ –≤–∫–ª—é—á–∞—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–≤–∞–∂–¥—ã
          result = Math.max(result, leftLIS[i] + rightLIS[i] - 1);
        }
      }
      // –æ—Å—Ç–∞—ë—Ç—Å—è –≤—ã—á–µ—Å—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–π,
      // —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–¥–∞–ª–µ–Ω–∏–π
      return nums.length - result;
    };
    
    /**
     * @param {number[]} nums
     * @return {number[]}
     */
    function LIS(nums) {
      const result = [...Array(nums.length)].fill(1);
    
      for (let i = 1; i < nums.length; i++) {
        // –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø—Ä–æ—Ö–æ–¥–∏–º—Å—è –ø–æ –≤—Å–µ–º dp[j], j = 0..i
        // —Ç.–µ. —Å–º–æ—Ç—Ä–∏–º –Ω–∞ –≤—Å–µ –¥–ª–∏–Ω—ã –î–û,
        // —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        for (let j = 0; j < i; j++) {
          if (nums[i] > nums[j]) {
            result[i] = Math.max(result[j] + 1, result[i]);
          }
        }
      }
      return result;
    }
    

PS. –û–±—Å—É–¥–∏—Ç—å –º–æ–∂–Ω–æ –≤ [—Ç–µ–ª–µ–≥—Ä–∞–º-—á–∞—Ç–µ](https://t.me/ctci_chat_ru) –ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–≤. Welcome! ü§ó

–ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Ç–µ—Å—å –Ω–∞ [–º–æ–π —Ç–≤–∏—Ç–µ—Ä](https://twitter.com/vitkarpov) –∏–ª–∏ [–∫–∞–Ω–∞–ª –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–µ](https://t.me/coding_interviews), —á—Ç–æ–±—ã —É–∑–Ω–∞–≤–∞—Ç—å –æ –Ω–æ–≤—ã—Ö —Ä–∞–∑–±–æ—Ä–∞—Ö –∑–∞–¥–∞—á.
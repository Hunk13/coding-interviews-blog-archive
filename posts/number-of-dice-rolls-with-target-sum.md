Number of Dice Rolls With Target Sum
====================================

Nov 9, 2020 ¬∑ 3 min read

–î–∞–Ω–æ `d` –∫—É–±–∏–∫–æ–≤ —Å `f` –≥—Ä–∞–Ω—è–º–∏, —Ç.–µ. –∫–∞–∂–¥—ã–π –∏–∑ –Ω–∏—Ö –º–æ–∂–µ—Ç –¥–∞—Ç—å —á–∏—Å–ª–æ –æ—Ç `1` –¥–æ `f`. –°–∫–æ–ª—å–∫–æ –µ—Å—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤—ã–∫–∏–Ω—É—Ç—å –∫—É–±–∏–∫–∏ —Ç–∞–∫, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞–Ω–Ω—É—é —Å—É–º–º—É `target`?

> –û—Ç–≤–µ—Ç –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å –ø–æ –º–æ–¥—É–ª—é 1e9 + 7, —á—Ç–æ–±—ã –Ω–µ –≤–æ–∑–∏—Ç—å—Å—è —Å BigInt –∏ —Ç–æ–º—É –ø–æ–¥–æ–±–Ω—ã–º

[–ó–∞–¥–∞—á–∞ –Ω–∞ LeetCode](https://leetcode.com/problems/number-of-dice-rolls-with-target-sum/).

–†–µ—à–µ–Ω–∏–µ¬†[#](#—Ä–µ—à–µ–Ω–∏–µ)
---------------------

–°–ø–µ—Ä–≤–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤, —á—Ç–æ–±—ã –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å –∑–∞–¥–∞—á—É:

    d = 1, f = 6, target = 3
    

–£ –Ω–∞—Å –µ—Å—Ç—å —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω –æ–±—ã—á–Ω—ã–π –∫—É–±–∏–∫ (6 –≥—Ä–∞–Ω–µ–π). –°–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤—ã–∫–∏–Ω—É—Ç—å —Å—É–º–º—É 3? –û–¥–∏–Ω –∫—É–±–∏–∫ ‚Äî –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç.

–¢–µ–ø–µ—Ä—å –¥—Ä—É–≥–æ–π, –º–µ–Ω–µ–µ —Ç—Ä–∏–≤–∏–∞–ª—å–Ω—ã–π, –ø—Ä–∏–º–µ—Ä.

    d = 2, f = 6, target = 7
    

–ù–∞ —ç—Ç–æ—Ç —Ä–∞–∑ –µ—Å—Ç—å –¥–≤–∞ –æ–±—ã—á–Ω—ã—Ö –∫—É–±–∏–∫–∞, –∏ —Å–ª–µ–¥—É—é—â–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã: `1+6`, `2+5`, `3+4`, `4+3`, `5+2`, `6+1`. –í—Å–µ–≥–æ 6 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤. –°—Ç–æ–∏—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å–∏–º–º–µ—Ç—Ä–∏—é.

–í—Å–µ–≥–æ `f^d` –≤–æ–∑–º–æ–∂–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤—ã–∫–∏–Ω—É—Ç—å –∫—É–±–∏–∫, –º–æ–∂–µ—Ç –ø–µ—Ä–µ–±—Ä–∞—Ç—å –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏ –ø–æ—Å—á–∏—Ç–∞—Ç—å –Ω—É–∂–Ω—ã–µ —Å—É–º–º—ã? –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤ –∑–∞–¥–∞—á–µ `1 <= d, f <= 30`, –ø–æ—ç—Ç–æ–º—É —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ –Ω–µ –ø—Ä–æ–π–¥—ë—Ç. –ü–µ—Ä–µ–π–¥—ë–º —Å—Ä–∞–∑—É –∫ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é.

–ö–∞–∫ —è —É–∂–µ –≥–æ–≤–æ—Ä–∏–ª –≤ [–∑–∞–¥–∞—á–µ –ø—Ä–æ —Ä–æ–±–æ—Ç–∞](http://localhost:1313/posts/unique-paths/), –≤ –∫–∞—á–µ—Å—Ç–≤–µ –¥–ø—à–µ—á–∫–∏ –æ–±—ã—á–Ω–æ –±–µ—Ä—ë—Ç—Å—è –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å —Å–∞–º–æ–π –∑–∞–¥–∞—á–∏. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ ‚Äî —Å–∫–æ–ª—å–∫–æ –µ—Å—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤—ã–±—Ä–æ—Å–∏—Ç—å `d` –∫—É–±–∏–∫–æ–≤ —Å —Å—É–º–º–æ–π `target`.

–ü–æ–ª—É—á–∞–µ—Ç—Å—è –∫–≤–∞–¥—Ä–∞—Ç–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞, –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—É–±–∏–∫–æ–≤, –∞ —Å—Ç–æ–ª–±–µ—Ü ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø–æ–ª—É—á–∏—Ç—å —Å—É–º–º—É, —Ä–∞–≤–Ω—É—é –Ω–æ–º–µ—Ä—É —Å—Ç–æ–ª–±—Ü–∞. –ü—Ä–æ—â–µ –≥–æ–≤–æ—Ä—è, `dp[d - 1][target - 1]` –¥–æ–ª–∂–µ–Ω –¥–∞—Ç—å –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å –∏—Å—Ö–æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏.

–ë–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π ‚Äî –æ–¥–∏–Ω –∫—É–±–∏–∫.

```js
const dp = new Array(d).fill(0).map(
  () => new Array(target).fill(0)
);

for (let t = 1; t <= target; t++) {
  // —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç,
  // –µ—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥—Ä–∞–Ω–µ–π –ø–æ–∑–≤–æ–ª—è–µ—Ç
  // –≤—ã–∫–∏–Ω—É—Ç—å –Ω—É–∂–Ω—É—é —Å—É–º–º—É
  dp[0][t - 1] = t <= f ? 1 : 0;
}
```

–î–∞–ª–µ–µ –Ω–∞—á–∏–Ω–∞–µ–º –∑–∞–ø–æ–ª–Ω—è—Ç—å –º–∞—Ç—Ä–∏—Ü—É —Ä—è–¥ –∑–∞ —Ä—è–¥–æ–º, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –ø—Ä–∏–±–ª–∏–∂–∞—è—Å—å –∫ —Ä–µ—à–µ–Ω–∏—é. –ö–∞–∫–æ–π —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥?

–†–µ—à–µ–Ω–∏–µ –¥–ª—è `dp[d][t]` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å—É–º–º–æ–π –ø–æ –≤—Å–µ–º —Å—Ç–æ—Ä–æ–Ω–∞–º (`1..f`) –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∫—É–±–∏–∫–æ–≤ –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É –º–µ–Ω—å—à–µ (`d - 1`). –ï—Å–ª–∏ –∑–Ω–∞–µ–º —Å—É–º–º—É –¥–ª—è `dp[d - 1][t - k]` ‚Äî –≤—Å–µ–≥–¥–∞ –º–æ–∂–Ω–æ –≤—ã–∫–∏–Ω—É—Ç—å –µ—â—ë –æ–¥–∏–Ω –∫—É–±–∏–∫ —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º `k`, —á—Ç–æ –∏ –ø—Ä–∏–≤–µ–¥—ë—Ç –≤ –Ω—É–∂–Ω—É—é —Å—É–º–º—É `t`.

```js
/**
 * @param {number} d
 * @param {number} f
 * @param {number} target
 * @return {number}
 */
var numRollsToTarget = function(d, f, target) {
  const dp = new Array(d).fill(0).map(
    () => new Array(target).fill(0)
  );
  const MOD = 1e9 + 7;

  for (let t = 1; t <= target; t++) {
    // —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç,
    // –µ—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥—Ä–∞–Ω–µ–π –ø–æ–∑–≤–æ–ª—è–µ—Ç
    // –≤—ã–∫–∏–Ω—É—Ç—å –Ω—É–∂–Ω—É—é —Å—É–º–º—É
    dp[0][t - 1] = t <= f ? 1 : 0;
  }

  // –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∑–∞–ø–æ–ª–Ω—è–µ–º –≤—Å—é –º–∞—Ç—Ä–∏—Ü—É,
  // –±–µ–∂–∏–º –ø–æ –≤—Å–µ–º –∫—É–±–∏–∫–∞–º –∏ —Å—É–º–º–∞–º
  for (let y = 1; y < d; y++) {
    for (let x = 0; x < target; x++) {
      // —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥,
      // —Å–∫–ª–∞–¥—ã–≤–∞–µ–º –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ–ª—É—á–∏—Ç—å —Å—É–º–º—É x - k
      // –∏–º–µ—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—É–±–∏–∫–æ–≤ –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É –º–µ–Ω—å—à–µ
      dp[y][x] = [...Array(f + 1).keys()].slice(1).reduce(
        (sum, k) => {
          // –Ω–µ–ª—å–∑—è –≤—ã–∫–∏–Ω—É—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—É—é —Å—É–º–º—É,
          // —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ —ç—Ç–æ ¬´–Ω–æ–ª—å –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤¬ª,
          // –ø–æ —Å—É—Ç–∏ –µ—â—ë –æ–¥–∏–Ω –±–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π
          if (x - k < 0) {
            return sum;
          }
          return (sum + dp[y - 1][x - k]) % MOD;
        }, 0);
    }
  }
  return dp[d - 1][target - 1];
};
```

PS. –û–±—Å—É–¥–∏—Ç—å –º–æ–∂–Ω–æ –≤ [—Ç–µ–ª–µ–≥—Ä–∞–º-—á–∞—Ç–µ](https://t.me/ctci_chat_ru) –ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–≤. Welcome! ü§ó

–ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Ç–µ—Å—å –Ω–∞ [–º–æ–π —Ç–≤–∏—Ç–µ—Ä](https://twitter.com/vitkarpov) –∏–ª–∏ [–∫–∞–Ω–∞–ª –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–µ](https://t.me/coding_interviews), —á—Ç–æ–±—ã —É–∑–Ω–∞–≤–∞—Ç—å –æ –Ω–æ–≤—ã—Ö —Ä–∞–∑–±–æ—Ä–∞—Ö –∑–∞–¥–∞—á.
Maximum Profit in Job Scheduling
================================

Mar 1, 2021 ¬∑ 4 min read

–ï—Å—Ç—å `n` –∑–∞–¥–∞—á, –∫–∞–∂–¥–∞—è –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–¥–∞–Ω–∞ –¥–≤—É–º—è –æ—Ç—Ä–µ–∑–∫–∞–º–∏ –≤—Ä–µ–º–µ–Ω–∏: –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü, –∞ —Ç–∞–∫ –∂–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º ¬´–ø—Ä–æ—Ñ–∏—Ç–æ–º¬ª, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—à—å –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏.

–ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω–∞–±–æ—Ä –∑–∞–¥–∞—á, –∫–æ—Ç–æ—Ä—ã–µ –¥–∞–¥—É—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏—Ç.

–ó–∞–¥–∞—á–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ—Å–µ–∫–∞—Ç—å—Å—è, —Ç–æ –µ—Å—Ç—å –≤ –∫–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ä–æ–≤–Ω–æ –æ–¥–Ω—É –∑–∞–¥–∞—á—É. –ö–∞–∫ —Ç–æ–ª—å–∫–æ –∑–∞–¥–∞—á–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è, —Ç–æ _—Å—Ä–∞–∑—É –∑–∞ –Ω–µ–π_ –º–æ–∂–Ω–æ –±—Ä–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é (–≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –æ–¥–Ω–æ–π –∏ –Ω–∞—á–∞–ª–∞ –¥—Ä—É–≥–æ–π –º–æ–≥—É—Ç —Å–æ–≤–ø–∞–¥–∞—Ç—å).

–ü—Ä–∏–º–µ—Ä:

![](https://assets.leetcode.com/uploads/2019/10/10/sample22_1584.png)

–ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π:

![](/images/maximum-profit--ex.jpg)

–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏—Ç 20 + 70 + 60 = 150. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤ –∫—Ä–∞—Å–Ω–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –Ω–µ–ª—å–∑—è –≤–∑—è—Ç—å 100 –∏–ª–∏ 70, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–µ–¥—ã–¥—É—â–∞—è –∑–∞–¥–∞—á–∞ ¬´–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ¬ª.

–†–µ—à–µ–Ω–∏–µ¬†[#](#—Ä–µ—à–µ–Ω–∏–µ)
---------------------

–í –ø—Ä–∏–Ω—Ü–∏–ø–µ, –º—ã –º–æ–∂–µ–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π. –û–¥–Ω–∞–∫–æ, —ç—Ç–æ –±—É–¥–µ—Ç –æ—á–µ–Ω—å –¥–æ–ª–≥–æ, —Å —É—á—ë—Ç–æ–º —Ç–µ–∫—É—â–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á –¥–æ `5 * 10^4`.

–ö–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –∏–∑–±–µ–∂–∞—Ç—å –ø–æ–ª–Ω–æ–≥–æ –ø–µ—Ä–µ–±–æ—Ä–∞? –ü–æ–ø—Ä–æ–±—É–µ–º —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—É—é –ø—Ä–∏—Ä–æ–¥—É –∑–∞–¥–∞—á–∏, –∏ —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –≤ –ø–µ—Ä–µ—Ö–æ–¥–µ –∫ —Ä–µ—à–µ–Ω–∏—é —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

–í —Ä–µ–∫—É—Ä—Å–∏–∏ –≤–∞–∂–Ω—ã –¥–≤–µ –≤–µ—â–∏:

*   –±–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π
*   —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ

–ë–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π, –∫–æ–≥–¥–∞ –Ω–µ—Ç –∑–∞–¥–∞—á. –ï—Å–ª–∏ –Ω–µ—Ç –∑–∞–¥–∞—á ‚Äî —Ç–æ –∏ –ø—Ä–æ—Ñ–∏—Ç —Ä–∞–≤–µ–Ω –Ω—É–ª—é. –ï—Å–ª–∏ –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞ ‚Äî –≤–∑—è—Ç—å –µ—ë –ø—Ä–æ—Ñ–∏—Ç.

–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –µ—Å–ª–∏ —É –Ω–∞—Å –µ—Å—Ç—å –¥–≤–µ –∑–∞–¥–∞—á–∏? –ï—Å—Ç—å –≤—ã–±–æ—Ä:

*   –≤–∑—è—Ç—å —Å–ª–µ–¥—É—é—â—É—é –∑–∞–¥–∞—á—É –≤ —Ä–∞–±–æ—Ç—É, –ø—Ä–∏—Å—Ç–µ–≥–Ω—É–≤ –µ—ë –≤ —Ç–µ–∫—É—â–µ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ (–µ—Å–ª–∏ –º–æ–∂–Ω–æ);
*   –Ω–µ –±—Ä–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é –∑–∞–¥–∞—á—É –≤ —Ç–µ–∫—É—â–µ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ, –∞ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∏—Ç—å –Ω–æ–≤–æ–µ —Å–æ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–¥–∞—á–∏.

–ß—Ç–æ –µ—Å–ª–∏ —É –Ω–∞—Å —Ç—Ä–∏, —á–µ—Ç—ã—Ä–µ, `n` –∑–∞–¥–∞—á? –í —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –º—ã –≤—ã—á–∏—Å–ª–∏–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏—Ç –¥–ª—è `n - 1` –∑–∞–¥–∞—á. –ò –º–æ–∂–Ω–æ —ç—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å!

    /**
     * –í—ã—á–∏—Å–ª—è–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏—Ç
     * –¥–ª—è ¬´—Ö–≤–æ—Å—Ç–∞¬ª —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á,
     * –≥–¥–µ n ‚Äî –¥–ª–∏–Ω–∞ —Ö–≤–æ—Å—Ç–∞.
     */
    function getMaxProfit(n) {
      // –±–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π,
      // –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–¥–∞—á
      if (n === TASKS_LEN) {
        return 0;
      }
      // –µ—Å—Ç—å –¥–≤–∞ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞:
      return Math.max(
        // –≤–æ–∑—å–º–µ–º —Ç–µ–∫—É—â—É—é –∑–∞–¥–∞—á—É –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ,
        // –∏ –ø–æ–ø—Ä–æ–±—É–µ–º –ø—Ä–∏—Å—Ç–µ–≥–Ω—É—Ç—å –∫ –Ω–µ–π —Å–ª–µ–¥—É—é—â–∏–π
        // –¥–æ—Å—Ç—É–ø–Ω—ã–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å–ª–æ—Ç
        profitOfTask(n) + getMaxProfit(findNextSlotAvailable(n)),
        // –Ω–µ –±—É–¥–µ–º –±—Ä–∞—Ç—å —Ç–µ–∫—É—â—É—é –∑–∞–¥–∞—á—É –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ,
        // –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –Ω–∞—á–Ω—ë–º —Å—Ç—Ä–æ–∏—Ç—å –Ω–æ–≤–æ–µ
        // —Å–æ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–¥–∞—á–∏
        getMaxProfit(n + 1)
      );
    }
    

–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤ –≤ —Ç–∞–∫–æ–º –¥–µ—Ä–µ–≤–µ –≤—ã–∑–æ–≤–æ–≤ –±—É–¥–µ—Ç —Ä–∞—Å—Ç–∏ –¥–æ–≤–æ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ, —Å —É—á—ë—Ç–æ–º —Ç–æ–≥–æ, —á—Ç–æ –º—ã —Å–æ–∑–¥–∞—ë–º –ø–æ –¥–≤–∞ –Ω–æ–≤—ã—Ö –≤—ã–∑–æ–≤–∞ –≤ –∫–∞–∂–¥–æ–º —Å–ª–µ–¥—É—é—â–µ–º ‚Äî `O(2^n)`.

–ó–¥–µ—Å—å –Ω–∞ –ø–æ–º–æ—â—å –ø—Ä–∏—Ö–æ–¥–∏—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏–ª–∏ –º–µ–º–æ–∏–∑–∞—Ü–∏—è. –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –Ω–æ —Ä–∞–∑–Ω—ã–º–∏ –ø—É—Ç—è–º–∏ –≤ –¥–µ—Ä–µ–≤–µ –≤—ã–∑–æ–≤–æ–≤, –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –∑–∞–∫–µ—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ `n`.

–ì—Ä—É–±–æ –≥–æ–≤–æ—Ä—è, –µ—Å–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏—Ç –±—ã–ª –≤—ã—á–∏—Å–ª–µ–Ω –æ–¥–∏–Ω —Ä–∞–∑, —Ç–æ ¬´–º–∞–∫—Å–∏–º–∞–ª—å–Ω–µ–µ¬ª –æ–Ω —É–∂–µ –Ω–µ —Å—Ç–∞–Ω–µ—Ç, –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é.

–¢–∞—Å–∫–∏ –∑–∞–¥–∞—é—Ç—Å—è —Ç—Ä—ë–º—è —Ä–∞–∑–Ω—ã–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏: `startTime`, `endTime` –∏ `profit`. –≠—Ç–æ –Ω–µ –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ, –ø–æ—ç—Ç–æ–º—É —Å–ø–µ—Ä–≤–∞ —Å–æ–±–µ—Ä—ë–º –≤—Å–µ –≤ –æ–¥–∏–Ω –º–∞—Å—Å–∏–≤ —Å —É–¥–æ–±–Ω—ã–º–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏.

    function buildNodesList() {
      const nodes = [];
      const len = startTime.length;
    
      for (let i = 0; i < len; i++) {
        nodes.push({ s: startTime[i], e: endTime[i], p: profit[i] });
      }
      return nodes;
    }
    

–¢–∞–∫ –∂–µ —É–¥–æ–±–Ω–æ –µ–≥–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—Ç–∞—Ä—Ç–∞ –∑–∞–¥–∞—á–∏, —á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–µ–µ –±—ã–ª–æ –∏—Å–∫–∞—Ç—å ¬´—Å–ª–µ–¥—É—é—â–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã–π —Å–ª–æ—Ç¬ª.

    function findNextSlotAvailable(start) {
      // –Ω–∞—á–∏–Ω–∞–µ–º –ø–æ–∏—Å–∫ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Å–ª–æ—Ç–∞
      // —Å–æ start + 1,
      // –∏—â–µ–º –ø–æ–∫–∞ –Ω–µ –Ω–∞–π–¥—ë—Ç—Å—è –ø–µ—Ä–≤—ã–π —Ç–∞—Å–∫,
      // –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç—Å—è —Å —Ç–µ–∫—É—â–∏–º
      for (let i = start + 1; i < len; i++) {
        if (nodes[i].s >= nodes[start].e) {
          return i;
        }
      }
      return len;
    }
    

–í—Å—ë –≤–º–µ—Å—Ç–µ.

    /**
     * @param {number[]} startTime
     * @param {number[]} endTime
     * @param {number[]} profit
     * @return {number}
     */
    var jobScheduling = function(startTime, endTime, profit) {
      const TASKS_LEN = startTime.length;
    
      // –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Å–ø–∏—Å–æ–∫ —É–∑–ª–æ–≤ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
      const nodes = buildNodesList();
    
      // –æ—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º, —á—Ç–æ–±—ã —É–¥–æ–±–Ω–µ–µ –∏—Å–∫–∞—Ç—å
      // —Å–ª–µ–¥—É—é—â–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã–π —Ç–∞—Å–∫
      nodes.sort((a, b) => a.s - b.s);
    
      // –¥–ª—è –º–µ–º–æ–∏–∑–∞—Ü–∏–∏
      const dp = new Array(TASKS_LEN).fill(0);
    
      // —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏—Ç
      // –¥–ª—è —Å—É—Ñ—Ñ–∏–∫—Å–∞ –Ω–∞—á–∏–Ω–∞—è —Å start
      function getMaxProfit(start) {
        // –±–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π,
        // —Å—É—Ñ—Ñ–∏–∫—Å –¥–ª–∏–Ω—ã –Ω–æ–ª—å,
        // —Ç–æ –µ—Å—Ç—å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–¥–∞—á
        if (start === TASKS_LEN) {
          return 0;
        }
        // –ø–æ–ø–∞–ª–∏ –≤ –∫–µ—à
        if (dp[start]) {
          return dp[start];
        }
        dp[start] = Math.max(
          nodes[start].p + getMaxProfit(findNextSlotAvailable(start)),
          getMaxProfit(start + 1)
        );
        return dp[start];
      }
      // –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏,
      // –æ–ø–∏—Å–∞–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ
      function buildNodesList() {
        const nodes = [];
        for (let i = 0; i < TASKS_LEN; i++) {
          nodes.push({ s: startTime[i], e: endTime[i], p: profit[i] });
        }
        return nodes;
      }
      function findNextSlotAvailable(start) {
        for (let i = start + 1; i < TASKS_LEN; i++) {
          if (nodes[i].s >= nodes[start].e) {
            return i;
          }
        }
        return TASKS_LEN;
      }
      // —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç –Ω–∞ –∑–∞–¥–∞—á—É,
      // –Ω—É–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –¥–ª—è —Å—É—Ñ—Ñ–∏–∫—Å–∞ —Ä–∞–∑–º–µ—Ä–æ–º
      // —Å –∏–∑–Ω–∞—á–∞–ª—å–Ω—ã–π –º–∞—Å—Å–∏–≤
      return getMaxProfit(0);
    };
    

![](/images/maximum-profit--result.jpg)

PS. –û–±—Å—É–¥–∏—Ç—å –º–æ–∂–Ω–æ –≤ [—Ç–µ–ª–µ–≥—Ä–∞–º-—á–∞—Ç–µ](https://t.me/ctci_chat_ru) –ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–≤. Welcome! ü§ó

–ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Ç–µ—Å—å –Ω–∞ [–º–æ–π —Ç–≤–∏—Ç–µ—Ä](https://twitter.com/vitkarpov) –∏–ª–∏ [–∫–∞–Ω–∞–ª –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–µ](https://t.me/coding_interviews), —á—Ç–æ–±—ã —É–∑–Ω–∞–≤–∞—Ç—å –æ –Ω–æ–≤—ã—Ö —Ä–∞–∑–±–æ—Ä–∞—Ö –∑–∞–¥–∞—á.